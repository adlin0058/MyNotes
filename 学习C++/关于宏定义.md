# 宏定义#define
---
## 概念
用来将一个**标识符**定义为一个字符串，该标识符被称为**宏名**，被定义的字符串被称为**替换文本**
#### 简单的宏定义
1. #define <宏名> <字符串>
2. 例： #define PI 3.1415926
#### 带参数的宏定义
1. #define <宏名> (<参数表>) <宏体>
2. 例： #define A(x) x

一个标识符被宏定义后，该标识符便是一个宏名
在程序被编译前，**宏名**被定义的**字符串**替换，称为宏替换

---

## 宏发生的时机

1. 文件包含
   把源程序中的#include拓展为文件正文
   即 把把包含的 **.h** 文件找到并展开到#include处
2. 条件编译
   预处理器根据 #if 和 #ifdef等编译命令及其后的条件，将源文件包含进来或排除在外，通常把排除在外的语句转换成空行
3. 宏展开
   即 上述的#define功能

---
## 注意事项

1. 宏定义替换**宏名**的字符串为一个表达式时，容易引起误解和误用
   如：
   ```C
   #define N 2+2
   a = N * N;
   ```
   
   结果为 a = 8
   编译器解析为 a = 2 + 2 * 2 + 2 = 8

   与本义不符
   要达到 a = 16的效果，应改为
   ```C
   #define N (2 + 2)
   ```
2. 带参数的宏定义出现问题
   写成下面这样较好
   ```C
   #define area(x) ((x) * (x))
   ```
---
## 宏定义的优点

1. 方便程序修改
2. 提高程序的运行效率

---
## 常用的宏定义

1. 防止一个头文件被重复包含
   ```cpp
   #ifndef BODYDEF_H
   #define BODYDEF_H
   //头文件内容
   #endif
   ```
2. 得到指定地址上的一个字节或字
3. 得到一个field在结构体(struct)中的偏移量
4. 得到一个结构体中的fielf所占的字节数
5. 得到一个变量的地址
6. 将一个字母转换为大写
   ```cpp
   #define UPCASE(c) ( ((c) >= "a" && (c) <= "z") ? ((c) - 0x20) : (c) )
   ```
7. 判断字符是不是10进制的数字
   ```cpp
   #define DECCHK(c) ((c) >= "0" && (c) <= "0")
   ```
 8. 判断字符是不是16进制的数字
 9. 防止溢出的一个方法
 10. 返回数组元素个数
   
    
    ```cpp
    #define ARR_SIZE(a) (sizeof((a)) / sizeof((a[0])))
    ```
11.  使用一些宏跟踪调试